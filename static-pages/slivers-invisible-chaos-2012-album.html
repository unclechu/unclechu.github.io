<!DOCTYPE html>
<html lang="ru">
<head>
	<meta charset="UTF-8">
	<meta name="author" content="Viacheslav Lotsmanov">
	<title>SLIVERS — Невидимый Хаос</title>
	<style>
		/* general reset */
		html, body, main, footer, section, div, span, p, small, h1, h2, h3, h4,
		img, ul, ol, li, audio, source, a, strong, em, dl, dt, dd {
			margin: 0;
			padding: 0;
			border: 0;
			font-size: 100%;
			font-family: sans-serif;
			vertical-align: baseline;
		}
		input, button {
			font-size: 100%;
			font-family: sans-serif;
			vertical-align: baseline;
		}
		body {
			line-height: 1;
			padding: 20px;
			min-width: 600px;
			box-sizing: border-box;
		}
		body, button {
			background: #020300;
			color: #92462e;
			text-shadow:
				0px 0px 4px black,
				0px 0px 3px black,
				0px 0px 2px black,
				0px 0px 1px black;
		}
		button {
			padding: 8px;
			margin: 0;
			border: 3px solid;
			border-left-color: #92462e;
			border-top-color: #92462e;
			border-right-color: #621c08;
			border-bottom-color: #621c08;
		}
		button:active {
			border-left-color: #621c08;
			border-top-color: #621c08;
			border-right-color: #92462e;
			border-bottom-color: #92462e;
		}
		.underlay {
			display: block;
			position: fixed;
			left: 0;
			top: 0;
			width: 100%;
			height: 100%;
			z-index: -1;
			background: url(https://matrix-client.matrix.org/_matrix/media/r0/download/pony.modular.im/31100592f5a187fee0385aebfade55d4218814cf) no-repeat center top fixed;
			background-size: cover;
			opacity: 0.4;
		}
		main, h1, h2, p, footer, dd, dt, dd {
			line-height: 1.5em;
		}
		main, footer {
			z-index: 0;
			text-align: center;
		}
		h1 {
			font-weight: bold;
			font-size: 200%;
		}
		h2 {
			font-weight: bold;
			font-size: 120%;
			margin-top: 20px;
		}
		h1 + h2 {
			margin-top: 0;
		}
		h3 {
			font-weight: bold;
			font-size: 100%;
			margin-top: 20px;
		}
		h4 {
			display: inline;
			font-weight: normal;
			font-size: 100%;
		}
		img {
			display: inline-block;
			width: auto;
			height: auto;
			min-width: 400px;
			max-width: 100%;
			min-height: 200px;
			border: 3px solid #92462e;
			box-sizing: border-box;
			font-size: 100%;
		}
		audio {
			display: block;
			width: 100%;
		}
		p {
			margin-top: 20px;
		}
		p.info {
			margin: 20px auto 0 auto;
			text-align: left;
		}
		a {
			color: #bbb;
			text-decoration: underline;
			display: block;
			transition: color .3s ease-in-out;
		}
		a:hover, a:active {
			color: #777;
		}
		em.info {
			display: block;
			margin: 0 auto;
			text-align: left;
		}
		ul, ol {
			list-style-type: none;
			counter-reset: section;
			margin: 0 auto;
			text-align: left;
			margin-top: 20px;
			position: relative;
		}
		ul li, ol li {
			margin-top: 10px;
			position: relative;
		}
		ol li::before, ul li::before {
			position: absolute;
			left: -5px;
			transform: translateX(-100%);
		}
		ol li::before {
			counter-increment: section;
			content: counters(section, "") ". ";
		}
		ul li::before {
			content: "• ";
		}
		footer {
			margin-top: 40px;
			line-height: 1.5em;
		}
		footer > small {
			display: block;
			line-height: 1.5em;
		}
		input:disabled, input:disabled + span {
			cursor: not-allowed;
		}
		input:disabled + span {
			color: #555;
		}
		dl {
			display: block;
			margin: 0 auto;
			text-align: left;
		}
		dl > dt {
			display: block;
			font-weight: bold;
			margin-top: 20px;
		}
		dl > dd {
			display: block;
			padding-left: 20px;
		}
		dl > dd > label, dl > dd > div {
			margin-top: 10px;
			display: block;
			position: relative;
		}
		dl > dd > label > input + span::before {
			content: "";
			display: block;
			cursor: pointer;
			position: absolute;
			left: 0;
			top: 0;
			width: 100%;
			height: 100%;
			z-index: 1;
		}
		dl > dd > label > input:disabled + span::before {
			cursor: not-allowed;
		}
		.playlist-buttons {
			margin-top: 20px;
			font-size: 500%;
		}
		.playlist-buttons button {
			background: transparent;
			margin: 0;
			padding: 0;
			border: 0;
		}
		.playlist-buttons button:disabled {
			cursor: not-allowed;
			color: #555;
		}
		section.font-size-switch > ul {
			text-align: center;
			margin-bottom: 20px;
		}
		section.font-size-switch > ul > li {
			display: inline-block;
		}
		section.font-size-switch > ul > li::before {
			display: none;
		}
		section.font-size-switch > ul > li:nth-child(2),
		html.font-size-2 section.font-size-switch .sized,
		html.font-size-2 main,
		html.font-size-2 footer > small {
			font-size: 200%;
		}
		section.font-size-switch > ul > li:nth-child(3),
		html.font-size-3 section.font-size-switch .sized,
		html.font-size-3 main,
		html.font-size-3 footer > small {
			font-size: 300%;
		}
		p.info,
		em.info,
		ul,
		ol,
		dl {
			max-width: 400px;
		}
		html.font-size-2 p.info,
		html.font-size-2 em.info,
		html.font-size-2 ul,
		html.font-size-2 ol,
		html.font-size-2 dl {
			max-width: 600px;
			padding-left: 40px;
		}
		html.font-size-2 .playlist-buttons {
			font-size: 350%;
		}
		html.font-size-3 p.info,
		html.font-size-3 em.info,
		html.font-size-3 ul,
		html.font-size-3 ol,
		html.font-size-3 dl {
			max-width: 800px;
			padding-left: 40px;
			padding-right: 40px;
		}
		html.font-size-3 .playlist-buttons {
			font-size: 350%;
		}
		html.font-size-3 body {
			min-width: 800px;
		}
		html.font-size-2 main input,
		section.font-size-switch > ul > li:nth-child(2) input {
			transform: scale(2) translateY(-10%);
			margin-right: 5px;
		}
		html.font-size-3 main input,
		section.font-size-switch > ul > li:nth-child(3) input {
			transform: scale(3) translateY(-16%);
			margin-right: 10px;
		}
		section.font-size-switch > ul > li:nth-child(2) {
			margin-left: 50px;
		}
		section.font-size-switch > ul > li:nth-child(3) {
			margin-left: 60px;
		}
	</style>
</head>
<body>
	<div class="underlay"></div>
	<main>
		<section>
			<h1>SLIVERS — Невидимый Хаос</h1>
			<h2>LP 2012</h2>
			<p>
				<img
					alt="Фронтальная обложка альбома"
					src="https://matrix-client.matrix.org/_matrix/media/r0/download/pony.modular.im/1fdc4742982e7a25fe895db5fc448b52e0358eaa"
				>
			</p>
			<p>
				<img
					alt="Оборотная сторона обложки в коробке от компакт-диска со списком песен"
					src="https://matrix-client.matrix.org/_matrix/media/r0/download/pony.modular.im/b04d23f921fecbe118a993ee56c5a4d10b398299"
				>
			</p>
		</section>
		<section>
			<h2>Аудиозаписи</h2>
			<section>
				<h3>MP3</h3>
				<div class="js-playlist-buttons"></div>
				<ol>
					<li>
						<h4>Мы создали ложь</h4>
						<audio controls>
							<source src="https://matrix-client.matrix.org/_matrix/media/r0/download/pony.modular.im/a861d8d3de2d53d627ff73f9b89ed7bb6a17f40f" type="audio/mpeg">
							<source src="https://pony.modular.im/_matrix/media/r0/download/pony.modular.im/a861d8d3de2d53d627ff73f9b89ed7bb6a17f40f" type="audio/mpeg">
						</audio>
					</li>
					<li>
						<h4>Фиаско</h4>
						<audio controls>
							<source src="https://matrix-client.matrix.org/_matrix/media/r0/download/pony.modular.im/37d0dc3bdd097b7ceeb0b302990e4afb65aeb493" type="audio/mpeg">
							<source src="https://pony.modular.im/_matrix/media/r0/download/pony.modular.im/37d0dc3bdd097b7ceeb0b302990e4afb65aeb493" type="audio/mpeg">
						</audio>
					</li>
					<li>
						<h4>Серое небо</h4>
						<audio controls>
							<source src="https://matrix-client.matrix.org/_matrix/media/r0/download/pony.modular.im/6879ec61e3012714c18ff6f320f9cdd464ff3d3f" type="audio/mpeg">
							<source src="https://pony.modular.im/_matrix/media/r0/download/pony.modular.im/6879ec61e3012714c18ff6f320f9cdd464ff3d3f" type="audio/mpeg">
						</audio>
					</li>
					<li>
						<h4>Настроение тишины</h4>
						<audio controls>
							<source src="https://matrix-client.matrix.org/_matrix/media/r0/download/pony.modular.im/0ed518ecf3ad4abb47299562e0e28a3a39b1b696" type="audio/mpeg">
							<source src="https://pony.modular.im/_matrix/media/r0/download/pony.modular.im/0ed518ecf3ad4abb47299562e0e28a3a39b1b696" type="audio/mpeg">
						</audio>
					</li>
					<li>
						<h4>Ухожу с приветом</h4>
						<audio controls>
							<source src="https://matrix-client.matrix.org/_matrix/media/r0/download/pony.modular.im/1227ebe7a67d83bb434cd14b6a986a7bfb920a40" type="audio/mpeg">
							<source src="https://pony.modular.im/_matrix/media/r0/download/pony.modular.im/1227ebe7a67d83bb434cd14b6a986a7bfb920a40" type="audio/mpeg">
						</audio>
					</li>
					<li>
						<h4>Пойми меня</h4>
						<audio controls>
							<source src="https://matrix-client.matrix.org/_matrix/media/r0/download/pony.modular.im/bcec2de56160db8505fa3cdf811972d4c8fa3681" type="audio/mpeg">
							<source src="https://pony.modular.im/_matrix/media/r0/download/pony.modular.im/bcec2de56160db8505fa3cdf811972d4c8fa3681" type="audio/mpeg">
						</audio>
					</li>
					<li>
						<h4>Как жаль, что мне не сделать рая</h4>
						<audio controls>
							<source src="https://matrix-client.matrix.org/_matrix/media/r0/download/pony.modular.im/e6e6e1ec006c9694006f0a9a472e88abfb1eab64" type="audio/mpeg">
							<source src="https://pony.modular.im/_matrix/media/r0/download/pony.modular.im/e6e6e1ec006c9694006f0a9a472e88abfb1eab64" type="audio/mpeg">
						</audio>
					</li>
					<li>
						<h4>Под снегом</h4>
						<audio controls>
							<source src="https://matrix-client.matrix.org/_matrix/media/r0/download/pony.modular.im/50fd1317c5bbeb07ade92ba280c61c6d213b312d" type="audio/mpeg">
							<source src="https://pony.modular.im/_matrix/media/r0/download/pony.modular.im/50fd1317c5bbeb07ade92ba280c61c6d213b312d" type="audio/mpeg">
						</audio>
					</li>
					<li>
						<h4>Невидимый хаос</h4>
						<audio controls>
							<source src="https://matrix-client.matrix.org/_matrix/media/r0/download/pony.modular.im/8a3bdfd399172d0dd657fc31479f1ba8dd3561bf" type="audio/mpeg">
							<source src="https://pony.modular.im/_matrix/media/r0/download/pony.modular.im/8a3bdfd399172d0dd657fc31479f1ba8dd3561bf" type="audio/mpeg">
						</audio>
					</li>
				</ol>
			</section>
			<section>
				<h3>FLAC</h3>
				<em class="info">
					Формат без потерь качества, более требователен
					к стабильности и пропускной способности интернет-соединения.
				</em>
				<div class="js-playlist-buttons"></div>
				<ol>
					<li>
						<h4>Мы создали ложь</h4>
						<audio controls>
							<source src="https://matrix-client.matrix.org/_matrix/media/r0/download/pony.modular.im/c4090058f7d2f5f9eb2172f447844096bd63e4aa" type="audio/flac">
							<source src="https://pony.modular.im/_matrix/media/r0/download/pony.modular.im/c4090058f7d2f5f9eb2172f447844096bd63e4aa" type="audio/flac">
						</audio>
					</li>
					<li>
						<h4>Фиаско</h4>
						<audio controls>
							<source src="https://matrix-client.matrix.org/_matrix/media/r0/download/pony.modular.im/a1fd30bdedfaf3c8989f12e1a5d9537aaa1a3608" type="audio/flac">
							<source src="https://pony.modular.im/_matrix/media/r0/download/pony.modular.im/a1fd30bdedfaf3c8989f12e1a5d9537aaa1a3608" type="audio/flac">
						</audio>
					</li>
					<li>
						<h4>Серое небо</h4>
						<audio controls>
							<source src="https://matrix-client.matrix.org/_matrix/media/r0/download/pony.modular.im/4191d26a79d0ef83ebf34bb8e998984c34877f90" type="audio/flac">
							<source src="https://pony.modular.im/_matrix/media/r0/download/pony.modular.im/4191d26a79d0ef83ebf34bb8e998984c34877f90" type="audio/flac">
						</audio>
					</li>
					<li>
						<h4>Настроение тишины</h4>
						<audio controls>
							<source src="https://matrix-client.matrix.org/_matrix/media/r0/download/pony.modular.im/97b774773008c5ba499f4b2f4c205db370d2592b" type="audio/flac">
							<source src="https://pony.modular.im/_matrix/media/r0/download/pony.modular.im/97b774773008c5ba499f4b2f4c205db370d2592b" type="audio/flac">
						</audio>
					</li>
					<li>
						<h4>Ухожу с приветом</h4>
						<audio controls>
							<source src="https://matrix-client.matrix.org/_matrix/media/r0/download/pony.modular.im/9c8e61256b5a27e1aee1c7b873eff4329f8be8c8" type="audio/flac">
							<source src="https://pony.modular.im/_matrix/media/r0/download/pony.modular.im/9c8e61256b5a27e1aee1c7b873eff4329f8be8c8" type="audio/flac">
						</audio>
					</li>
					<li>
						<h4>Пойми меня</h4>
						<audio controls>
							<source src="https://matrix-client.matrix.org/_matrix/media/r0/download/pony.modular.im/09f6b83936888fd5dc1cd4f872a3cf60777e5b45" type="audio/flac">
							<source src="https://pony.modular.im/_matrix/media/r0/download/pony.modular.im/09f6b83936888fd5dc1cd4f872a3cf60777e5b45" type="audio/flac">
						</audio>
					</li>
					<li>
						<h4>Как жаль, что мне не сделать рая</h4>
						<audio controls>
							<source src="https://matrix-client.matrix.org/_matrix/media/r0/download/pony.modular.im/c5baa62e8725dba16035f6015e197fb00677bbbe" type="audio/flac">
							<source src="https://pony.modular.im/_matrix/media/r0/download/pony.modular.im/c5baa62e8725dba16035f6015e197fb00677bbbe" type="audio/flac">
						</audio>
					</li>
					<li>
						<h4>Под снегом</h4>
						<audio controls>
							<source src="https://matrix-client.matrix.org/_matrix/media/r0/download/pony.modular.im/ee0439072d3a4b6b6a3c5c796ccf614a32a7f294" type="audio/flac">
							<source src="https://pony.modular.im/_matrix/media/r0/download/pony.modular.im/ee0439072d3a4b6b6a3c5c796ccf614a32a7f294" type="audio/flac">
						</audio>
					</li>
					<li>
						<h4>Невидимый хаос</h4>
						<audio controls>
							<source src="https://matrix-client.matrix.org/_matrix/media/r0/download/pony.modular.im/10e8e3887e183aa338eeb280946d70785ef81681" type="audio/flac">
							<source src="https://pony.modular.im/_matrix/media/r0/download/pony.modular.im/10e8e3887e183aa338eeb280946d70785ef81681" type="audio/flac">
						</audio>
					</li>
				</ol>
			</section>
			<div id="js-checkboxes"></div>
		</section>
		<section>
			<h2>Арты для компакт-диска</h2>
			<p>
				<img
					alt="Принт на компакт-диске"
					src="https://matrix-client.matrix.org/_matrix/media/r0/download/pony.modular.im/b74c43b98eb8d2aac602466bd5d86c51fd096487"
				>
			</p>
			<p>
				<img
					alt="Развёртка первой страницы буклета со списком участников группы и людей, участвовавших в записи, сведении и мастеринге альбома"
					src="https://matrix-client.matrix.org/_matrix/media/r0/download/pony.modular.im/45b7415a33a02b209c8298e7affdc23b922bb7af"
				>
			</p>
			<p>
				<img
					alt="Развёртка второй страницы буклета с художественным изображением"
					src="https://matrix-client.matrix.org/_matrix/media/r0/download/pony.modular.im/72b5266cad7b466673835dd7bdcf97413c8be745"
				>
			</p>
			<p>
				<img
					alt="Внутренняя часть коробки от компакт-диска с фоновым изображением"
					src="https://matrix-client.matrix.org/_matrix/media/r0/download/pony.modular.im/31100592f5a187fee0385aebfade55d4218814cf"
				>
			</p>
		</section>
		<section>
			<h2>Информация</h2>
			<p class="info">
				Альтернативная рок-группа из Черкесска.
				Образована весной 2007 года.
				Вскоре после выхода этого дебютного альбома группа распалась.
				Впоследствии фронтменом Ильясом была образована другая группа под
				названием <strong>Кабирия</strong> в Ростове-на-Дону.
			</p>
		</section>
		<section>
			<h2>Ссылки</h2>
			<section>
				<h3>Скачать альбом</h3>
				<ul>
					<li>
						<a href="https://rutracker.org/forum/viewtopic.php?t=4189292">
							(Alternative rock / Grunge / Grungegaze) SLIVERS - Невидимый Хаос - 2012, FLAC (tracks), lossless :: RuTracker.org
						</a>
						Torrent
					</li>
					<li>
						<a href="https://rutracker.org/forum/viewtopic.php?t=4190651">
							(Alternative rock / Grunge / Grungegaze) SLIVERS - Невидимый Хаос - 2012, MP3, 320 kbps :: RuTracker.org
						</a>
						Torrent
					</li>
				</ul>
			</section>
			<section>
				<h3>Прочие ссылки</h3>
				<ul>
					<li>
						<a href="https://kabiria.bandcamp.com/">Кабирия on Bandcamp</a>
						Впоследствии образованная фронтменом группа
						после распада <strong>SLIVERS</strong>.
					</li>
				</ul>
			</section>
		</section>
	</main>
	<footer>
		<div id="js-font-size-switcher"></div>
		<small lang="en">
			This page has been updated on 19 April 2020
			by Viacheslav Lotsmanov<br>
			@unclechu:matrix.org
		</small>
	</footer>
	<script>
		// Alternative domain source for images failed to load
		function imgResourceFailover(isCssBackground, el) {
			if (isCssBackground && !window.getComputedStyle) return
			var fakeImg = new Image()
			
			var src = !isCssBackground ? el.src :
				window.getComputedStyle(el)
					.getPropertyValue('background-image')
					.replace(/(^url\(|\)$)/g, '')
					.replace(/^"(.*)"$/, '$1')
				
			function onError() {
				src = src.replace(
					/\/\/matrix-client\.matrix\.org\//g,
					'//pony.modular.im/'
				)
				if (isCssBackground) el.style.backgroundImage = 'url("'+src+'")'
				else el.src = src
				done()
			}
			
			function onLoad() { done() }
			
			function done() {
				fakeImg.removeEventListener('error', onError)
				fakeImg.removeEventListener('load', onLoad)
				fakeImg.remove()
				onError = onLoad = fakeImg = undefined
			}
			
			fakeImg.addEventListener('error', onError)
			fakeImg.addEventListener('load', onLoad)
			fakeImg.src = src
		}
		
		// All <img> tags
		Object.values(document.querySelectorAll('img')).forEach(function (img) {
			imgResourceFailover(false, img)
		})
		
		// CSS background-image elements
		imgResourceFailover(true, document.querySelector('.underlay'))
	</script>
	<script type="text/template" id="js-playlist-buttons-template">
		<div class="playlist-buttons">
			<button class="js-prev">&#x23EE;</button>
			<button class="js-play-pause"></button>
			<button class="js-stop">&#x23F9;</button>
			<button class="js-next-repeat"></button>
		</div>
	</script>
	<script>
		// Big playlist buttons handling script
		
		var playlistButtonsWraps =
			document.querySelectorAll('.js-playlist-buttons')
		
		// Render them first
		var playlistButtonsTpl =
			document.getElementById('js-playlist-buttons-template').innerHTML
		
		var playSymbol = '&#x23F5;'
		var pauseSymbol = '&#x23F8;'
		var nextSymbol = '&#x23ED;'
		var repeatSymbol = '&#x21BA;'
		
		Object.values(playlistButtonsWraps).forEach(function (wrap) {
			wrap.innerHTML = playlistButtonsTpl
			
			var prev = wrap.querySelector('.js-prev')
			var playPause = wrap.querySelector('.js-play-pause')
			var stop = wrap.querySelector('.js-stop')
			var nextRepeat = wrap.querySelector('.js-next-repeat')
			
			var parent = wrap.closest('section')
			var allTracks = parent.querySelectorAll('audio')
			
			var currentTrack
			var prevTrack
			var nextTrack
			
			function setPrevAndNext() {
				var li = currentTrack.closest('li')
				
				// First sibling is a text node
				nextTrack = li.nextSibling
				if (nextTrack) nextTrack = nextTrack.nextSibling
				if (nextTrack) nextTrack = nextTrack.querySelector('audio')
				if (!nextTrack) nextTrack = allTracks[0]
				
				// First sibling is a text node
				prevTrack = li.previousSibling
				if (prevTrack) prevTrack = prevTrack.previousSibling
				if (prevTrack) prevTrack = prevTrack.querySelector('audio')
			}
			
			function getPlayingTracks() {
				return Object.values(allTracks)
					.filter(function (audio) { return !audio.paused })
			}
			
			function updateBtnsState() {
				var playingCount = getPlayingTracks().length
				prev.disabled = (playingCount > 1) || !prevTrack
				playPause.innerHTML = (playingCount > 0) ? pauseSymbol : playSymbol
				stop.disabled = playingCount < 1
				
				nextRepeat.innerHTML =
					(playingCount < 2) && (nextTrack === allTracks[0]) ?
						repeatSymbol : nextSymbol
				
				nextRepeat.disabled = playingCount > 1
			}
			
			currentTrack = allTracks[0]
			setPrevAndNext()
			updateBtnsState()
			
			Object.values(allTracks).forEach(function (audio) {
				audio.addEventListener('play', function () {
					currentTrack = this
					setPrevAndNext()
					updateBtnsState()
				})
				
				audio.addEventListener('pause', function () {
					updateBtnsState()
				})
			})
			
			prev.addEventListener('click', function (e) {
				e.preventDefault()
				var playingTracks = getPlayingTracks()
				
				if (playingTracks.length)
					playingTracks.forEach(function (el) { el.pause() })
				
				if (prevTrack.currentTime > 0) prevTrack.currentTime = 0
				prevTrack.play()
			})
			
			playPause.addEventListener('click', function (e) {
				e.preventDefault()
				var playingTracks = getPlayingTracks()
				
				if (playingTracks.length)
					playingTracks.forEach(function (el) { el.pause() })
				else
					currentTrack.play()
			})
			
			stop.addEventListener('click', function (e) {
				e.preventDefault()
				
				getPlayingTracks().forEach(function (el) {
					el.pause()
					el.currentTime = 0
				})
			})
			
			nextRepeat.addEventListener('click', function (e) {
				e.preventDefault()
				var playingTracks = getPlayingTracks()
				
				if (playingTracks.length)
					playingTracks.forEach(function (el) { el.pause() })
				
				if (nextTrack.currentTime > 0) nextTrack.currentTime = 0
				nextTrack.play()
			})
		})
	</script>
	<script type="text/template" id="js-checkboxes-template">
		<dl>
			<dt>Плейлист</dt>
			<dd>
				<label>
					<input type="checkbox" id="js-playlist">
					<span>Плейлист (воспроизводить следующий трек
					после окончания предыдущего)</span>
				</label>
				<label>
					<input type="checkbox" id="js-repeat">
					<span>Повторять плейлист по кругу</span>
				</label>
				<label>
					<input type="checkbox" id="js-reset-next-time">
					<span>Сбрасывать треки к их началу при переходе к следующему
					треку в плейлисте после окончания предыдущего</span>
				</label>
			</dd>
			<dt>Синхронизация</dt>
			<dd>
				<label>
					<input type="checkbox" id="js-sync-volume">
					<span>Общая регулировка громкости (при изменении громкости
					одного трека — остальные треки становятся той же
					громкости)</span>
				</label>
			</dd>
			<dt>Последовательность</dt>
			<dd>
				<label>
					<input type="checkbox" id="js-one-at-a-time">
					<span>Останавливать предыдущий играющий трек
					при включении другого (один играющий трек за раз)</span>
				</label>
				<label>
					<input type="checkbox" id="js-reset-switch-time">
					<span>Сбрасывать проигрывание к началу трека
					при переключении между играющими треками</span>
				</label>
			</dd>
			<dt>Настройки</dt>
			<dd>
				<label>
					<input type="checkbox" id="js-store-settings">
					<span>Сохранять настройки между перезагрузками страницы</span>
				</label>
				<div>
					<button id="js-reset-settings-to-defaults">
						Сбросить настройки к стандартным
					</button>
				</div>
			</dd>
		</dl>
	</script>
	<script type="text/template" id="js-font-size-switcher-template">
		<section class="font-size-switch">
			<div class="sized"><h2>Размер шрифта</h2></div>
			<ul>
				<li>
					<label>
						<input type="radio" name="font-size" value="1">
						<span>A1</span>
					</label>
				</li>
				<li>
					<label>
						<input type="radio" name="font-size" value="2">
						<span>A2</span>
					</label>
				</li>
				<li>
					<label>
						<input type="radio" name="font-size" value="3">
						<span>A3</span>
					</label>
				</li>
			</ul>
		</section>
	</script>
	<script>
		var allAudioTags = document.querySelectorAll('audio')
		
		document.getElementById('js-checkboxes').innerHTML =
			document.getElementById('js-checkboxes-template').innerHTML
		
		document.getElementById('js-font-size-switcher').innerHTML =
			document.getElementById('js-font-size-switcher-template').innerHTML
		
		var checkbox = {
			playlist: document.getElementById('js-playlist'),
			repeat: document.getElementById('js-repeat'),
			resetNextTime: document.getElementById('js-reset-next-time'),
			syncVolume: document.getElementById('js-sync-volume'),
			oneAtATime: document.getElementById('js-one-at-a-time'),
			resetSwitchTime: document.getElementById('js-reset-switch-time'),
			storeSettings: document.getElementById('js-store-settings')
		}
		
		var defaultCheckboxesState = {
			playlist: true,
			repeat: false,
			resetNextTime: true,
			syncVolume: true,
			oneAtATime: true,
			resetSwitchTime: true,
			storeSettings: true
		}
		
		var resetSettingsBtn =
			document.getElementById('js-reset-settings-to-defaults')
		
		function triggerFakeCheckboxesChangeEvent() {
			Object.values(checkbox).forEach(function (input) {
				input.dispatchEvent(new Event('change'))
			})
		}
		
		function applyCheckboxesState(state) {
			Object.keys(state).forEach(function (stateKey) {
				if (checkbox[stateKey] === undefined) return
				checkbox[stateKey].checked = state[stateKey]
			})
			
			triggerFakeCheckboxesChangeEvent()
		}
		
		resetSettingsBtn.addEventListener('click', function (e) {
			e.preventDefault()
			if (!confirm('Вы уверены что хотите сбросить настройки?')) return
			applyCheckboxesState(defaultCheckboxesState)
		})
		
		checkbox.playlist.addEventListener('change', function () {
			checkbox.repeat.disabled = !this.checked
			checkbox.resetNextTime.disabled = !this.checked
		})
		
		checkbox.oneAtATime.addEventListener('change', function () {
			if (!this.checked) return
			
			// <audio> tracks which are playing at the moment
			var playingTracks =
				Object.values(allAudioTags)
					.filter(function (el) { return !el.paused })
			
			// Stop all playing track but the first one playing
			// in case there are more than one playing tracks at the moment.
			if (playingTracks.length > 1) {
				playingTracks.shift()
				if (checkbox.oneAtATime.checked)
					playingTracks.forEach(function (el) { el.pause() })
			}
		})
		
		checkbox.oneAtATime.addEventListener('change', function () {
			checkbox.resetSwitchTime.disabled = !this.checked
		})
		
		var html = document.querySelector('html')
		var fontSizeSwitcherWrap = document.getElementById('js-font-size-switcher')
		var fontSizeSwitchers = fontSizeSwitcherWrap.querySelectorAll('input')
		
		function triggerFakeChangeFontSizeEvent() {
			var el = fontSizeSwitcherWrap.querySelector('input:checked')
			if (el) el.dispatchEvent(new Event('change'))
		}
		
		function applyFontSize(fontSize) {
			if (!fontSize) fontSize = 1
			fontSizeSwitcherWrap.querySelectorAll('input')[--fontSize].checked = true
			triggerFakeChangeFontSizeEvent()
		}
		
		Object.values(fontSizeSwitchers).forEach(function (input) {
			input.addEventListener('change', function () {
				if (!this.checked) return
				html.setAttribute('class', 'font-size-'+this.value)
			})
		})
		
		applyCheckboxesState(defaultCheckboxesState)
		
		function savePageSettings() { // Depends on window.localStorage
			var settings
			
			if (checkbox.storeSettings.checked) {
				settings = Object.keys(checkbox).reduce(function (res, key) {
					res[key] = checkbox[key].checked
					return res
				}, {})
				
				var fontSize = fontSizeSwitcherWrap.querySelector('input:checked')
				settings.fontSize = fontSize ? parseInt(fontSize.value) : 1
			} else {
				settings = { storeSettings: false }
			}
			
			window.localStorage.setItem('page-settings', JSON.stringify(settings))
		}
		
		function restorePageSettings() { // Depends on window.localStorage
			var settings = window.localStorage.getItem('page-settings')
			if (!settings) return // Have no saved settings yet
			
			try {
				settings = JSON.parse(settings)
				if (typeof settings !== 'object')
					throw new Error('Saved page settings value is not an object')
				var k
				if (Object.keys(settings).some(function (key) {
					return (
						k = key,
						(key !== 'fontSize' && typeof settings[key] !== 'boolean') ||
						(key === 'fontSize' && typeof settings[key] !== 'number')
					)
				}))
					throw new Error(
						JSON.stringify(k) + ' key of saved page settings has incorrect type'
					)
			} catch (e) {
				// You can just save them again to fix it
				if (console && console.error) {
					console.error('Saved page settings are corrupted! Error: ', e)
					console.error('Saved page settings value is:', JSON.stringify(settings))
				}
				return
			}
			
			applyCheckboxesState(settings)
			applyFontSize(settings.fontSize)
		}
		
		if (!fontSizeSwitcherWrap.querySelector('input:checked')) applyFontSize()
		
		if (window.localStorage) {
			restorePageSettings()
			Object.values(checkbox).forEach(function (input) {
				input.addEventListener('change', function () {
					savePageSettings()
				})
			})
			Object.values(fontSizeSwitchers).forEach(function (input) {
				input.addEventListener('change', function () {
					savePageSettings()
				})
			})
		} else
			checkbox.storeSettings.closest('label').style.display = 'none'
		
		Object.values(allAudioTags).forEach(function (audio) {
			// First sibling is a text node
			var next = audio.closest('li').nextSibling
			if (next) next = next.nextSibling
			if (next) next = next.querySelector('audio')
			
			// Make audio playing work like a playlist
			// (automatically play next track when previous one has ended).
			audio.addEventListener('ended', function () {
				if (!checkbox.playlist.checked) return
				if (checkbox.resetNextTime.checked) audio.currentTime = 0
				
				if (next) {
					if (checkbox.resetNextTime.checked) next.currentTime = 0
					next.play()
				} else if (checkbox.repeat.checked) {
					var first = audio.closest('ol').querySelector('audio')
					if (checkbox.resetNextTime.checked) first.currentTime = 0
					first.play()
				}
			})
			
			audio.addEventListener('play', function () {
				// <audio> tracks which are playing at the moment
				// except current <audio> which is just started to play.
				var playingTracks =
					Object.values(allAudioTags).filter(function (el) {
						return el !== audio && !el.paused
					})
				
				if (playingTracks.length > 0) {
					// Play from the beginning
					// if switching from another playing track
					if (
						checkbox.oneAtATime.checked &&
						checkbox.resetSwitchTime.checked &&
						audio.currentTime > 0
					)
						audio.currentTime = 0
					
					// Only one playing track at a time
					if (checkbox.oneAtATime.checked)
						playingTracks.forEach(function (el) { el.pause() })
				}
			})
			
			audio.addEventListener('volumechange', function () {
				if (!checkbox.syncVolume.checked) return
				
				Object.values(allAudioTags).forEach(function (el) {
					if (el === audio) return
					el.volume = audio.volume
					el.muted = audio.muted
				})
			})
		})
	</script>
</body>
</html>
